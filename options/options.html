<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <title>Opções - Auto Tab Grouper</title>
    <link rel="stylesheet" href="../vendor/tailwind.css" />
    <link rel="stylesheet" href="options.css" />
  </head>
  <body
    class="antialiased bg-slate-50 text-slate-800 dark:bg-slate-900 dark:text-slate-200 transition-colors duration-300"
  >
    <div class="container mx-auto p-4 md:p-8 max-w-5xl">
      <header class="flex justify-between items-center mb-10 text-center">
        <div></div>
        <!-- Espaçador -->
        <div>
          <h1
            class="text-5xl font-extrabold text-slate-900 dark:text-slate-100"
          >
            Auto Tab Grouper
          </h1>
          <p class="text-lg text-slate-500 dark:text-slate-400 mt-2">
            Ajuste a organização automática das suas abas.
          </p>
        </div>
        <a
          href="../help/help.html"
          target="_blank"
          class="bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 hover:bg-blue-200 dark:hover:bg-blue-800/60 font-semibold py-2 px-4 rounded-lg transition-colors"
        >
          ? Ajuda
        </a>
      </header>

      <section
        class="bg-white p-6 rounded-2xl shadow-lg mb-8 dark:bg-slate-800"
      >
        <h2
          class="text-2xl font-bold mb-5 border-b border-slate-200 pb-3 dark:border-slate-700"
        >
          Agrupamento
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
          <div
            class="flex items-center justify-between p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50"
          >
            <label for="groupingMode" class="font-semibold"
              >Estratégia de Nomenclatura:<button
                type="button"
                class="help-tooltip"
                data-help-key="groupingMode"
              >
                ?
              </button></label
            >
            <select
              id="groupingMode"
              class="p-2 border border-slate-300 rounded-md shadow-sm focus:ring-2 focus:ring-indigo-500 dark:bg-slate-700 dark:border-slate-600"
            >
              <option value="smart">Nomenclatura Inteligente</option>
              <option value="domain">Agrupar por Domínio</option>
              <option value="subdomain">Agrupar por Subdomínio</option>
            </select>
          </div>
          <div
            class="flex items-center justify-between p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50"
          >
            <label for="minTabsForAutoGroup" class="font-semibold"
              >Mínimo de abas para agrupar:<button
                type="button"
                class="help-tooltip"
                data-help-key="minTabsForAutoGroup"
              >
                ?
              </button></label
            >
            <input
              type="number"
              id="minTabsForAutoGroup"
              min="1"
              class="p-2 border border-slate-300 rounded-md shadow-sm w-32 focus:ring-2 focus:ring-indigo-500 dark:bg-slate-700 dark:border-slate-600"
            />
          </div>
          <div
            class="flex items-center justify-between p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50"
          >
            <label for="showTabCount" class="font-semibold"
              >Mostrar contador de abas no título:<button
                type="button"
                class="help-tooltip"
                data-help-key="showTabCount"
              >
                ?
              </button></label
            >
            <input
              type="checkbox"
              id="showTabCount"
              class="h-6 w-6 rounded text-indigo-600 focus:ring-indigo-500 border-slate-300 dark:border-slate-600 dark:bg-slate-700"
            />
          </div>
        </div>
      </section>

      <section
        class="bg-white p-6 rounded-2xl shadow-lg mb-8 dark:bg-slate-800"
      >
        <h2
          class="text-2xl font-bold mb-5 border-b border-slate-200 pb-3 dark:border-slate-700"
        >
          Comportamento dos Grupos
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
          <div
            class="flex items-center justify-between p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50"
          >
            <label for="uncollapseOnActivate" class="font-semibold"
              >Expandir grupo ao selecionar aba:<button
                type="button"
                class="help-tooltip"
                data-help-key="uncollapseOnActivate"
              >
                ?
              </button></label
            >
            <input
              type="checkbox"
              id="uncollapseOnActivate"
              class="h-6 w-6 rounded text-indigo-600 focus:ring-indigo-500 border-slate-300 dark:border-slate-600 dark:bg-slate-700"
            />
          </div>
          <div
            class="flex items-center justify-between p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50"
          >
            <label for="autoCollapseTimeout" class="font-semibold"
              >Recolher grupo após (segundos):<button
                type="button"
                class="help-tooltip"
                data-help-key="autoCollapseTimeout"
              >
                ?
              </button></label
            >
            <input
              type="number"
              id="autoCollapseTimeout"
              min="0"
              max="999999"
              class="p-2 border border-slate-300 rounded-md shadow-sm w-32 focus:ring-2 focus:ring-indigo-500 dark:bg-slate-700 dark:border-slate-600"
              placeholder="0 (desativado)"
            />
          </div>
          <div
            class="flex items-center justify-between p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-opacity"
          >
            <label for="ungroupSingleTabs" class="font-semibold"
              >Desagrupar aba solitária:<button
                type="button"
                class="help-tooltip"
                data-help-key="ungroupSingleTabs"
              >
                ?
              </button></label
            >
            <input
              type="checkbox"
              id="ungroupSingleTabs"
              class="h-6 w-6 rounded text-indigo-600 focus:ring-indigo-500 border-slate-300 dark:border-slate-600 dark:bg-slate-700"
            />
          </div>
          <div
            class="flex items-center justify-between p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-opacity"
          >
            <label for="ungroupSingleTabsTimeout" class="font-semibold"
              >Desagrupar aba após (segundos):<button
                type="button"
                class="help-tooltip"
                data-help-key="ungroupSingleTabsTimeout"
              >
                ?
              </button></label
            >
            <input
              type="number"
              id="ungroupSingleTabsTimeout"
              min="0"
              max="999999"
              class="p-2 border border-slate-300 rounded-md shadow-sm w-32 focus:ring-2 focus:ring-indigo-500 dark:bg-slate-700 dark:border-slate-600 disabled:opacity-50"
              placeholder="10"
            />
          </div>
          <div
            class="flex items-center justify-between p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50"
          >
            <label for="logLevel" class="font-semibold">Nível de Log:</label>
            <select
              id="logLevel"
              class="p-2 border border-slate-300 rounded-md shadow-sm focus:ring-2 focus:ring-indigo-500 dark:bg-slate-700 dark:border-slate-600"
            >
              <option value="INFO">Informação</option>
              <option value="DEBUG">Depuração (Debug)</option>
              <option value="WARN">Avisos (Warn)</option>
              <option value="ERROR">Erros</option>
              <option value="NONE">Nenhum</option>
            </select>
          </div>
          <div
            class="flex items-center justify-between p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50"
          >
            <label for="theme" class="font-semibold"
              >Tema:<button
                type="button"
                class="help-tooltip"
                data-help-key="theme"
              >
                ?
              </button></label
            >
            <select
              id="theme"
              class="p-2 border border-slate-300 rounded-md shadow-sm focus:ring-2 focus:ring-indigo-500 dark:bg-slate-700 dark:border-slate-600"
            >
              <option value="auto">Automático</option>
              <option value="light">Claro</option>
              <option value="dark">Escuro</option>
            </select>
          </div>
        </div>
      </section>

      <!-- NOVO: Seção de Sugestões Inteligentes -->
      <section
        class="bg-white p-6 rounded-2xl shadow-lg mb-8 dark:bg-slate-800"
      >
        <h2
          class="text-2xl font-bold mb-5 border-b border-slate-200 pb-3 dark:border-slate-700"
        >
          Sugestões Inteligentes
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
          <div
            class="flex items-center justify-between p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50"
          >
            <label for="suggestionsEnabled" class="font-semibold"
              >Ativar sugestões de grupo:<button
                type="button"
                class="help-tooltip"
                data-help-key="suggestionsEnabled"
              >
                ?
              </button></label
            >
            <input
              type="checkbox"
              id="suggestionsEnabled"
              class="h-6 w-6 rounded text-indigo-600 focus:ring-indigo-500 border-slate-300 dark:border-slate-600 dark:bg-slate-700"
            />
          </div>
          <div
            class="flex items-center justify-between p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50"
          >
            <label for="clearLearningHistoryBtn" class="font-semibold"
              >Histórico de aprendizado:<button
                type="button"
                class="help-tooltip"
                data-help-key="clearLearningHistory"
              >
                ?
              </button></label
            >
            <button
              id="clearLearningHistoryBtn"
              class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg shadow-sm transition duration-200 text-sm"
            >
              Limpar Histórico
            </button>
          </div>
          <div
            class="flex items-center justify-between p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50"
          >
            <label for="showLearningDataBtn" class="font-semibold"
              >Dados de aprendizado:<button
                type="button"
                class="help-tooltip"
                data-help-key="showLearningData"
              >
                ?
              </button></label
            >
            <button
              id="showLearningDataBtn"
              class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow-sm transition duration-200 text-sm"
            >
              Ver Dados Armazenados
            </button>
          </div>
          <div
            class="flex items-center justify-between p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50"
          >
            <label for="learningEnabled" class="font-semibold"
              >Aprendizado automático:<button
                type="button"
                class="help-tooltip"
                data-help-key="learningEnabled"
              >
                ?
              </button></label
            >
            <input
              type="checkbox"
              id="learningEnabled"
              class="h-6 w-6 rounded text-indigo-600 focus:ring-indigo-500 border-slate-300 dark:border-slate-600 dark:bg-slate-700"
              checked
            />
          </div>
        </div>
      </section>
      <!-- FIM NOVO -->

      <!-- NOVO: Seção de Renomeação Automática de Abas -->
      <section
        class="bg-white p-6 rounded-2xl shadow-lg mb-8 dark:bg-slate-800"
      >
        <div
          class="flex justify-between items-center mb-5 border-b border-slate-200 pb-3 dark:border-slate-700"
        >
          <h2 class="text-2xl font-bold flex items-center">
            Renomeação Automática de Abas
            <button
              type="button"
              class="help-tooltip"
              data-help-key="tabRenaming"
            >
              ?
            </button>
          </h2>
          <div class="flex items-center space-x-2">
            <label for="tabRenamingEnabled" class="font-semibold"
              >Ativar Renomeação:</label
            >
            <input
              type="checkbox"
              id="tabRenamingEnabled"
              class="h-6 w-6 rounded text-indigo-600 focus:ring-indigo-500 border-slate-300 dark:border-slate-600 dark:bg-slate-700"
            />
          </div>
        </div>
        <p class="text-sm text-slate-500 mb-4 dark:text-slate-400">
          Crie regras para renomear automaticamente os títulos das suas abas. As
          regras são aplicadas em ordem de prioridade (de cima para baixo).
        </p>
        <div class="flex justify-end mb-4">
          <button
            id="addRenamingRuleBtn"
            class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-200 dark:bg-indigo-500 dark:hover:bg-indigo-600"
          >
            Adicionar Nova Regra de Renomeação
          </button>
        </div>
        <div id="renamingRulesList" class="space-y-3"></div>
      </section>
      <!-- FIM NOVO: Seção de Renomeação Automática de Abas -->

      <section
        class="bg-white p-6 rounded-2xl shadow-lg mb-8 dark:bg-slate-800"
      >
        <h2
          class="text-2xl font-bold mb-5 border-b border-slate-200 pb-3 dark:border-slate-700"
        >
          Diagnóstico de Memória
        </h2>
        <div class="space-y-4">
          <div
            class="flex items-center justify-between p-3 rounded-lg bg-slate-50 dark:bg-slate-700/50"
          >
            <span class="font-semibold">Status da Memória e Cache:</span>
            <div class="flex gap-2">
              <button
                id="refreshMemoryStats"
                class="px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm"
              >
                Atualizar
              </button>
              <button
                id="cleanupMemory"
                class="px-3 py-1 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm"
              >
                Limpar Memória
              </button>
              <button
                id="clearCacheBtn"
                class="px-3 py-1 bg-red-600 text-white rounded-md hover:bg-red-700 text-sm"
              >
                Limpar Cache
              </button>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <div class="bg-slate-100 dark:bg-slate-700 p-3 rounded-lg">
              <div class="text-sm text-slate-600 dark:text-slate-400">
                Mapa Aba-Grupo
              </div>
              <div id="memoryTabGroupMap" class="text-lg font-semibold">-</div>
            </div>
            <div class="bg-slate-100 dark:bg-slate-700 p-3 rounded-lg">
              <div class="text-sm text-slate-600 dark:text-slate-400">
                Updaters de Título
              </div>
              <div id="memoryTitleUpdaters" class="text-lg font-semibold">
                -
              </div>
            </div>
            <div class="bg-slate-100 dark:bg-slate-700 p-3 rounded-lg">
              <div class="text-sm text-slate-600 dark:text-slate-400">
                Atividade de Grupos
              </div>
              <div id="memoryGroupActivity" class="text-lg font-semibold">
                -
              </div>
            </div>
            <div class="bg-slate-100 dark:bg-slate-700 p-3 rounded-lg">
              <div class="text-sm text-slate-600 dark:text-slate-400">
                Cache de Nomes
              </div>
              <div id="memorySmartCache" class="text-lg font-semibold">-</div>
            </div>
            <div class="bg-slate-100 dark:bg-slate-700 p-3 rounded-lg">
              <div class="text-sm text-slate-600 dark:text-slate-400">
                Falhas de Injeção
              </div>
              <div id="memoryInjectionFailures" class="text-lg font-semibold">
                -
              </div>
            </div>
            <div class="bg-slate-100 dark:bg-slate-700 p-3 rounded-lg">
              <div class="text-sm text-slate-600 dark:text-slate-400">
                Grupos Pendentes
              </div>
              <div id="memoryPendingGroups" class="text-lg font-semibold">
                -
              </div>
            </div>
          </div>

          <div class="mt-4 p-3 rounded-lg bg-blue-50 dark:bg-blue-900/20">
            <div class="text-sm text-blue-700 dark:text-blue-300">
              <strong>Última Limpeza:</strong>
              <span id="lastCleanupTime">-</span>
            </div>
            <div class="text-sm text-blue-700 dark:text-blue-300">
              <strong>Total Limpo:</strong>
              <span id="totalCleaned">-</span> entradas
            </div>
            <div class="text-sm text-blue-700 dark:text-blue-300">
              <strong>Ciclos de Limpeza:</strong>
              <span id="cleanupCycles">-</span>
            </div>
          </div>
        </div>
      </section>

      <section
        class="bg-white p-6 rounded-2xl shadow-lg mb-8 dark:bg-slate-800"
      >
        <h2
          class="text-2xl font-bold mb-5 border-b border-slate-200 pb-3 dark:border-slate-700"
        >
          Configurações de Performance
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="space-y-4">
            <div>
              <label for="queueDelay" class="block text-sm font-medium mb-1">
                Delay da Fila (ms):
              </label>
              <input
                type="number"
                id="queueDelay"
                min="100"
                max="5000"
                step="50"
                class="w-full p-2 border border-slate-300 rounded-md dark:bg-slate-700 dark:border-slate-600"
              />
              <p class="text-xs text-slate-600 dark:text-slate-400 mt-1">
                Tempo de espera antes de processar fila de abas
              </p>
            </div>

            <div>
              <label for="batchSize" class="block text-sm font-medium mb-1">
                Tamanho do Lote:
              </label>
              <input
                type="number"
                id="batchSize"
                min="10"
                max="100"
                step="5"
                class="w-full p-2 border border-slate-300 rounded-md dark:bg-slate-700 dark:border-slate-600"
              />
              <p class="text-xs text-slate-600 dark:text-slate-400 mt-1">
                Número de operações processadas em lote
              </p>
            </div>
          </div>

          <div class="space-y-4">
            <div>
              <label
                for="maxInjectionRetries"
                class="block text-sm font-medium mb-1"
              >
                Máx. Tentativas Injeção:
              </label>
              <input
                type="number"
                id="maxInjectionRetries"
                min="1"
                max="10"
                class="w-full p-2 border border-slate-300 rounded-md dark:bg-slate-700 dark:border-slate-600"
              />
              <p class="text-xs text-slate-600 dark:text-slate-400 mt-1">
                Tentativas de injeção de script antes de desistir
              </p>
            </div>

            <div>
              <label
                for="performanceLogging"
                class="flex items-center space-x-2"
              >
                <input
                  type="checkbox"
                  id="performanceLogging"
                  class="rounded border-slate-300 dark:border-slate-600"
                />
                <span class="text-sm font-medium">Log de Performance</span>
              </label>
              <p class="text-xs text-slate-600 dark:text-slate-400 mt-1">
                Registra operações que demoram mais que o esperado
              </p>
            </div>
          </div>
        </div>

        <div
          class="mt-6 pt-4 border-t border-slate-200 dark:border-slate-700 flex gap-2"
        >
          <button
            id="resetPerformanceConfig"
            class="px-4 py-2 bg-slate-600 text-white rounded-md hover:bg-slate-700 text-sm"
          >
            Restaurar Padrões
          </button>
          <button
            id="savePerformanceConfig"
            class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm"
          >
            Salvar Configurações
          </button>
        </div>
      </section>

      <section
        class="bg-white p-6 rounded-2xl shadow-lg mb-8 dark:bg-slate-800"
      >
        <h2
          class="text-2xl font-bold mb-5 border-b border-slate-200 pb-3 dark:border-slate-700"
        >
          Higienização Avançada
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          <div>
            <label for="domainSanitizationTlds" class="font-semibold mb-2 block"
              >TLDs a ignorar:<button
                type="button"
                class="help-tooltip"
                data-help-key="domainSanitizationTlds"
              >
                ?
              </button></label
            >
            <textarea
              id="domainSanitizationTlds"
              class="w-full p-2 border border-slate-300 rounded-md shadow-sm font-mono text-sm dark:bg-slate-700 dark:border-slate-600"
              rows="10"
            ></textarea>
            <p class="text-sm text-slate-500 mt-2 dark:text-slate-400">
              Os mais longos (ex: .gov.br) devem vir antes dos mais curtos (ex:
              .br).
            </p>
          </div>
          <div>
            <label for="titleSanitizationNoise" class="font-semibold mb-2 block"
              >Palavras a ignorar em títulos:<button
                type="button"
                class="help-tooltip"
                data-help-key="titleSanitizationNoise"
              >
                ?
              </button></label
            >
            <textarea
              id="titleSanitizationNoise"
              class="w-full p-2 border border-slate-300 rounded-md shadow-sm font-mono text-sm dark:bg-slate-700 dark:border-slate-600"
              rows="10"
            ></textarea>
            <p class="text-sm text-slate-500 mt-2 dark:text-slate-400">
              Palavras que, se encontradas, penalizam um segmento de título.
            </p>
          </div>
          <div class="md:col-span-2">
            <label for="titleDelimiters" class="font-semibold mb-2 block"
              >Delimitadores de Título:<button
                type="button"
                class="help-tooltip"
                data-help-key="titleDelimiters"
              >
                ?
              </button></label
            >
            <input
              type="text"
              id="titleDelimiters"
              class="w-full p-2 border border-slate-300 rounded-md shadow-sm font-mono text-sm dark:bg-slate-700 dark:border-slate-600"
            />
            <p class="text-sm text-slate-500 mt-2 dark:text-slate-400">
              Caracteres usados para separar o nome da marca do resto do título.
            </p>
          </div>
        </div>
      </section>

      <section
        class="bg-white p-6 rounded-2xl shadow-lg mb-8 dark:bg-slate-800"
      >
        <h2
          class="text-2xl font-bold mb-5 border-b border-slate-200 pb-3 dark:border-slate-700"
        >
          Exceções
        </h2>
        <div class="flex flex-col">
          <label for="exceptionsList" class="font-semibold mb-2"
            >Sites a serem ignorados (um por linha):<button
              type="button"
              class="help-tooltip"
              data-help-key="exceptionsList"
            >
              ?
            </button></label
          >
          <textarea
            id="exceptionsList"
            placeholder="Ex: mail.google.com
youtube.com"
            class="w-full p-2 border border-slate-300 rounded-md shadow-sm dark:bg-slate-700 dark:border-slate-600"
            rows="5"
          ></textarea>
          <p class="text-sm text-slate-500 mt-2 dark:text-slate-400">
            Qualquer URL que contenha o texto inserido será ignorada.
          </p>
        </div>
      </section>

      <section class="bg-white p-6 rounded-2xl shadow-lg dark:bg-slate-800">
        <div
          class="flex justify-between items-center mb-5 border-b border-slate-200 pb-3 dark:border-slate-700"
        >
          <h2 class="text-2xl font-bold flex items-center">
            Regras Personalizadas
            <button
              type="button"
              class="help-tooltip"
              data-help-key="customRules"
            >
              ?
            </button>
          </h2>
          <button
            id="addRuleBtn"
            class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-200 dark:bg-indigo-500 dark:hover:bg-indigo-600"
          >
            Adicionar Nova Regra
          </button>
        </div>
        <p class="text-sm text-slate-500 mb-4 dark:text-slate-400">
          A primeira regra na lista que corresponder será usada. Arraste e solte
          para reordenar.
        </p>
        <div id="rulesList" class="space-y-3"></div>
      </section>

      <section
        class="bg-white p-6 rounded-2xl shadow-lg mt-8 dark:bg-slate-800"
      >
        <h2
          class="text-2xl font-bold mb-5 border-b border-slate-200 pb-3 dark:border-slate-700 flex items-center"
        >
          Testador de Regras
          <button type="button" class="help-tooltip" data-help-key="ruleTester">
            ?
          </button>
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label for="ruleTesterUrl" class="font-semibold mb-2 block"
              >URL de Teste:</label
            >
            <input
              type="url"
              id="ruleTesterUrl"
              placeholder="https://www.github.com/usuario/repo"
              class="w-full p-2 border border-slate-300 rounded-md shadow-sm dark:bg-slate-700 dark:border-slate-600"
            />
          </div>
          <div>
            <label for="ruleTesterTitle" class="font-semibold mb-2 block"
              >Título de Teste:</label
            >
            <input
              type="text"
              id="ruleTesterTitle"
              placeholder="[PROJETO-X] Correção de bug"
              class="w-full p-2 border border-slate-300 rounded-md shadow-sm dark:bg-slate-700 dark:border-slate-600"
            />
          </div>
        </div>
        <div
          id="ruleTesterResult"
          class="mt-3 p-3 bg-slate-100 rounded-md text-slate-700 dark:bg-slate-700 dark:text-slate-300 min-h-[48px] transition-colors"
        >
          Aguardando entrada...
        </div>
      </section>

      <footer class="text-center mt-10 border-t dark:border-slate-700 pt-8">
        <div class="flex items-center justify-center mb-4">
          <input
            type="checkbox"
            id="syncEnabled"
            class="h-5 w-5 rounded text-indigo-600 focus:ring-indigo-500 border-slate-300 dark:border-slate-600 dark:bg-slate-700"
          />
          <label for="syncEnabled" class="ml-2 font-semibold"
            >Sincronizar configurações<button
              type="button"
              class="help-tooltip"
              data-help-key="syncEnabled"
            >
              ?
            </button></label
          >
        </div>
        <div class="flex items-center justify-center space-x-4 my-6">
          <button
            id="importBtn"
            class="bg-slate-500 hover:bg-slate-600 text-white font-bold py-2 px-4 rounded-lg"
          >
            Importar
          </button>
          <input type="file" id="importFile" accept=".json" class="hidden" />
          <button
            id="exportBtn"
            class="bg-slate-500 hover:bg-slate-600 text-white font-bold py-2 px-4 rounded-lg"
          >
            Exportar
          </button>
        </div>
        <div class="mt-8 text-sm text-slate-500 dark:text-slate-400">
          <p class="font-semibold mb-2">
            Gostou da extensão? Encontrou um problema?
          </p>
          <a
            href="https://github.com/ShadyBS/tab-group-automator/issues"
            target="_blank"
            class="text-indigo-600 dark:text-indigo-400 hover:underline"
          >
            Relate um bug ou sugira uma ideia no GitHub
          </a>
        </div>
        <div
          id="saveStatus"
          class="h-6 text-center font-semibold transition-colors mt-4"
        ></div>
      </footer>
    </div>

    <div
      id="ruleModal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 dark:bg-opacity-70 z-50 flex justify-center items-start pt-10 overflow-y-auto"
    >
      <div
        class="bg-white rounded-xl shadow-2xl p-6 md:p-8 w-full max-w-2xl m-4 dark:bg-slate-800"
      >
        <h3 id="modalTitle" class="text-2xl font-bold mb-6">Nova Regra</h3>
        <form id="ruleForm">
          <input type="hidden" id="ruleIndex" />
          <div class="space-y-4">
            <div>
              <label for="ruleName" class="font-semibold block mb-1"
                >Nome do Grupo</label
              >
              <input
                type="text"
                id="ruleName"
                placeholder="Ex: Pull Requests"
                class="w-full p-2 border border-slate-300 rounded-md shadow-sm dark:bg-slate-700 dark:border-slate-600"
                required
              />
            </div>
            <div>
              <label for="ruleColor" class="font-semibold block mb-1"
                >Cor do Grupo</label
              >
              <select
                id="ruleColor"
                class="w-full p-2 border border-slate-300 rounded-md shadow-sm dark:bg-slate-700 dark:border-slate-600"
              >
                <option value="grey">Cinzento</option>
                <option value="blue">Azul</option>
                <option value="red">Vermelho</option>
                <option value="yellow">Amarelo</option>
                <option value="green">Verde</option>
                <option value="pink">Rosa</option>
                <option value="purple">Roxo</option>
                <option value="cyan">Ciano</option>
                <option value="orange">Laranja</option>
              </select>
            </div>
            <div>
              <label for="ruleMinTabs" class="font-semibold block mb-1"
                >Mínimo de Abas no Grupo</label
              >
              <input
                type="number"
                id="ruleMinTabs"
                min="1"
                value="1"
                class="w-full p-2 border border-slate-300 rounded-md shadow-sm dark:bg-slate-700 dark:border-slate-600"
              />
              <p class="text-sm text-slate-500 mt-1 dark:text-slate-400">
                A regra só será aplicada se este número de abas for atingido.
              </p>
            </div>
          </div>

          <hr class="my-6 dark:border-slate-600" />

          <div>
            <div class="flex items-center space-x-4 mb-4">
              <h4 class="text-lg font-semibold">Agrupar abas SE</h4>
              <select
                id="ruleOperator"
                class="p-2 border border-slate-300 rounded-md shadow-sm dark:bg-slate-700 dark:border-slate-600"
              >
                <option value="AND">TODAS</option>
                <option value="OR">QUALQUER UMA</option>
              </select>
              <h4 class="text-lg font-semibold">
                das seguintes condições forem verdadeiras:
              </h4>
            </div>
            <div
              id="conditionsContainer"
              class="space-y-3 p-4 bg-slate-50 dark:bg-slate-700/50 rounded-lg"
            ></div>
            <button
              type="button"
              id="addConditionBtn"
              class="mt-4 bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg text-sm"
            >
              + Adicionar Condição
            </button>
          </div>

          <div class="flex justify-end space-x-4 mt-8">
            <button
              type="button"
              id="cancelRuleBtn"
              class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-lg dark:bg-slate-600 dark:text-slate-200 dark:hover:bg-slate-500"
            >
              Cancelar
            </button>
            <button
              type="submit"
              id="saveRuleBtn"
              class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg dark:bg-indigo-500 dark:hover:bg-indigo-600"
            >
              Salvar Regra
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- NOVO: Modal de Regras de Renomeação -->
    <div
      id="renamingRuleModal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 dark:bg-opacity-70 z-50 flex justify-center items-start pt-10 pb-10 overflow-y-auto"
    >
      <div
        class="bg-white rounded-xl shadow-2xl p-6 md:p-8 w-full max-w-3xl m-4 dark:bg-slate-800"
      >
        <h3 id="renamingModalTitle" class="text-2xl font-bold mb-6">
          Nova Regra de Renomeação
        </h3>
        <form id="renamingRuleForm">
          <input type="hidden" id="renamingRuleId" />
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label for="renamingRuleName" class="font-semibold block mb-1"
                >Nome da Regra<button
                  type="button"
                  class="help-tooltip"
                  data-help-key="renamingRuleName"
                >
                  ?
                </button></label
              >
              <input
                type="text"
                id="renamingRuleName"
                placeholder="Ex: Títulos de Artigos"
                class="w-full p-2 border border-slate-300 rounded-md shadow-sm dark:bg-slate-700 dark:border-slate-600"
                required
              />
            </div>
            <div>
              <label for="renamingRulePriority" class="font-semibold block mb-1"
                >Prioridade<button
                  type="button"
                  class="help-tooltip"
                  data-help-key="renamingPriority"
                >
                  ?
                </button></label
              >
              <input
                type="number"
                id="renamingRulePriority"
                min="1"
                max="999"
                value="100"
                class="w-full p-2 border border-slate-300 rounded-md shadow-sm dark:bg-slate-700 dark:border-slate-600"
              />
              <p class="text-sm text-slate-500 mt-1 dark:text-slate-400">
                Menor número = maior prioridade.
              </p>
            </div>
            <div class="md:col-span-2 flex items-center p-2">
              <input
                type="checkbox"
                id="renamingRuleEnabled"
                class="h-5 w-5 rounded text-indigo-600 focus:ring-indigo-500 border-slate-300 dark:border-slate-600 dark:bg-slate-700"
                checked
              />
              <label for="renamingRuleEnabled" class="ml-2 font-semibold"
                >Regra Ativada</label
              >
            </div>
          </div>

          <hr class="my-6 dark:border-slate-600" />

          <!-- Condições da Regra de Renomeação -->
          <div>
            <div class="flex items-center space-x-4 mb-4">
              <h4 class="text-lg font-semibold">
                Aplicar regra SE<button
                  type="button"
                  class="help-tooltip"
                  data-help-key="renamingConditions"
                >
                  ?
                </button>
              </h4>
              <select
                id="renamingRuleConditionOperator"
                class="p-2 border border-slate-300 rounded-md shadow-sm dark:bg-slate-700 dark:border-slate-600"
              >
                <option value="AND">TODAS</option>
                <option value="OR">QUALQUER UMA</option>
              </select>
              <h4 class="text-lg font-semibold">
                das seguintes condições forem verdadeiras:
              </h4>
            </div>
            <div
              id="renamingConditionsContainer"
              class="space-y-3 p-4 bg-slate-50 dark:bg-slate-700/50 rounded-lg"
            >
              <!-- Condições serão adicionadas aqui via JS -->
            </div>
            <button
              type="button"
              id="addRenamingConditionBtn"
              class="mt-4 bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg text-sm"
            >
              + Adicionar Condição
            </button>
          </div>

          <hr class="my-6 dark:border-slate-600" />

          <!-- Estratégias de Renomeação -->
          <div>
            <h4 class="text-lg font-semibold mb-3">
              Estratégias de Renomeação (aplicadas em ordem):<button
                type="button"
                class="help-tooltip"
                data-help-key="renamingStrategies"
              >
                ?
              </button>
            </h4>
            <div
              id="renamingStrategiesContainer"
              class="space-y-4 p-4 bg-slate-50 dark:bg-slate-700/50 rounded-lg"
            >
              <!-- Estratégias serão adicionadas aqui via JS -->
            </div>
            <button
              type="button"
              id="addRenamingStrategyBtn"
              class="mt-4 bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg text-sm"
            >
              + Adicionar Estratégia
            </button>
          </div>

          <hr class="my-6 dark:border-slate-600" />

          <!-- Opções Avançadas de Renomeação -->
          <div>
            <h4 class="text-lg font-semibold mb-3">
              Opções Avançadas:<button
                type="button"
                class="help-tooltip"
                data-help-key="advancedRenamingOptions"
              >
                ?
              </button>
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="flex items-center p-2">
                <input
                  type="checkbox"
                  id="renamingOptionWaitForLoad"
                  class="h-5 w-5 rounded text-indigo-600 focus:ring-indigo-500 border-slate-300 dark:border-slate-600 dark:bg-slate-700"
                />
                <label
                  for="renamingOptionWaitForLoad"
                  class="ml-2 font-semibold text-sm"
                  >Aguardar carregamento completo da página</label
                >
              </div>
              <div class="flex items-center p-2">
                <input
                  type="checkbox"
                  id="renamingOptionCacheResult"
                  class="h-5 w-5 rounded text-indigo-600 focus:ring-indigo-500 border-slate-300 dark:border-slate-600 dark:bg-slate-700"
                  checked
                />
                <label
                  for="renamingOptionCacheResult"
                  class="ml-2 font-semibold text-sm"
                  >Armazenar resultado em cache</label
                >
              </div>
              <div class="flex items-center p-2">
                <input
                  type="checkbox"
                  id="renamingOptionRespectManualChanges"
                  class="h-5 w-5 rounded text-indigo-600 focus:ring-indigo-500 border-slate-300 dark:border-slate-600 dark:bg-slate-700"
                  checked
                />
                <label
                  for="renamingOptionRespectManualChanges"
                  class="ml-2 font-semibold text-sm"
                  >Respeitar alterações manuais</label
                >
              </div>
              <div class="flex items-center p-2">
                <label
                  for="renamingOptionRetryAttempts"
                  class="font-semibold text-sm mr-2"
                  >Tentativas de Reaplicação:</label
                >
                <input
                  type="number"
                  id="renamingOptionRetryAttempts"
                  min="0"
                  max="5"
                  value="1"
                  class="w-20 p-1 border border-slate-300 rounded-md shadow-sm dark:bg-slate-700 dark:border-slate-600 text-sm"
                />
              </div>
            </div>
          </div>

          <div class="flex justify-end space-x-4 mt-8">
            <button
              type="button"
              id="cancelRenamingRuleBtn"
              class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-lg dark:bg-slate-600 dark:text-slate-200 dark:hover:bg-slate-500"
            >
              Cancelar
            </button>
            <button
              type="submit"
              id="saveRenamingRuleBtn"
              class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg dark:bg-indigo-500 dark:hover:bg-indigo-600"
            >
              Salvar Regra
            </button>
          </div>
        </form>
      </div>
    </div>
    <!-- FIM NOVO: Modal de Regras de Renomeação -->

    <!-- Modal para mostrar dados de aprendizado -->
    <div
      id="learningDataModal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 dark:bg-opacity-70 z-50 flex justify-center items-start pt-10 overflow-y-auto"
    >
      <div
        class="bg-white rounded-xl shadow-2xl p-6 md:p-8 w-full max-w-4xl m-4 dark:bg-slate-800"
      >
        <h3 class="text-2xl font-bold mb-6">Dados de Aprendizado Armazenados</h3>
        
        <div class="mb-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
          <p class="text-sm text-blue-700 dark:text-blue-300">
            <strong>Privacidade:</strong> Apenas nomes de domínio (ex: "github.com") são armazenados, nunca URLs completas ou dados pessoais.
          </p>
        </div>
        
        <div id="learningDataContent" class="max-h-96 overflow-y-auto">
          <!-- Conteúdo será preenchido via JavaScript -->
        </div>
        
        <div class="flex justify-end space-x-4 mt-6">
          <button
            id="closeLearningDataBtn"
            class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-lg dark:bg-slate-600 dark:text-slate-200 dark:hover:bg-slate-500"
          >
            Fechar
          </button>
        </div>
      </div>
    </div>

    <div
      id="confirmModal"
      class="hidden fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center p-4"
    >
      <div
        class="bg-white rounded-xl shadow-2xl p-8 w-full max-w-md dark:bg-slate-800"
      >
        <h3 class="text-xl font-bold mb-4 text-slate-800 dark:text-slate-100">
          Confirmar Ação
        </h3>
        <p
          id="confirmModalText"
          class="text-slate-600 mb-8 dark:text-slate-300"
        >
          Tem a certeza que deseja prosseguir?
        </p>
        <div class="flex justify-end space-x-4">
          <button
            id="confirmCancelBtn"
            class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-6 rounded-lg transition-colors dark:bg-slate-600 dark:text-slate-200 dark:hover:bg-slate-500"
          >
            Cancelar</button
          ><button
            id="confirmOkBtn"
            class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-lg transition-colors"
          >
            Confirmar
          </button>
        </div>
      </div>
    </div>

    <div
      id="notification-container"
      class="fixed bottom-5 right-5 w-80 space-y-3 z-50"
    ></div>

    <script src="../vendor/Sortable.min.js"></script>
    <script src="../vendor/browser-polyfill.js"></script>
    <script src="options.js" type="module"></script>
  </body>
</html>
